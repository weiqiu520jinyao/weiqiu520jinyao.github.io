<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>äº²çˆ±å®è´çš„ç‚¹é¤ç³»ç»Ÿ</title>
  <!-- å¼•å…¥Tailwind CSSï¼Œæ— éœ€æœ¬åœ°å®‰è£… -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- å¼•å…¥å­—ä½“å›¾æ ‡ï¼Œç”¨äºè´­ç‰©è½¦/åŠ å‡å· -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style type="text/tailwindcss">
    @layer utilities {
      .food-card {
        @apply bg-white rounded-lg shadow-md overflow-hidden transition-all hover:shadow-lg hover:scale-[1.02] duration-300;
      }
      .btn-num {
        @apply w-8 h-8 rounded-full flex items-center justify-center border border-gray-200 hover:bg-orange-500 hover:text-white transition-colors;
      }
      .category-active {
        @apply bg-orange-500 text-white;
      }
    }
    body {
      background-color: #f8f8f8;
      padding-bottom: 120px; /* ç»™åº•éƒ¨è´­ç‰©è½¦ç•™ç©ºé—´ */
    }
    /* åˆ†ç±»æ¨ªå‘æ»šåŠ¨æ— æ»šåŠ¨æ¡ */
    .category-scroll::-webkit-scrollbar {
      display: none;
    }
  </style>
</head>
<body>
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <header class="sticky top-0 bg-white shadow-sm py-3 px-4 z-10">
    <h1 class="text-center text-xl font-bold text-gray-800">ğŸ½ï¸ å¯çˆ±å®å® Â· ç‚¹é¤ç©ºé—´</h1>
  </header>

  <main class="container mx-auto px-3 mt-4">
    <!-- èœå“åˆ†ç±»æ  -->
    <div class="category-scroll overflow-x-auto mb-4">
      <div class="flex gap-2 whitespace-nowrap pb-2">
        <button class="category-btn category-active px-4 py-2 rounded-full text-sm transition-colors" data-type="all">å…¨éƒ¨èœå“</button>
        <button class="category-btn px-4 py-2 rounded-full text-sm transition-colors" data-type="hot">çˆ±å¿ƒæ¨è</button>
        <button class="category-btn px-4 py-2 rounded-full text-sm transition-colors" data-type="food">ä¸»é£Ÿå¥—é¤</button>
        <button class="category-btn px-4 py-2 rounded-full text-sm transition-colors" data-type="snack">å°åƒç‚¹å¿ƒ</button>
        <button class="category-btn px-4 py-2 rounded-full text-sm transition-colors" data-type="drink">é¥®å“å¥¶èŒ¶</button>
        <button class="category-btn px-4 py-2 rounded-full text-sm transition-colors" data-type="soup">æ±¤å“ç²¥å“</button>
      </div>
    </div>

    <!-- èœå“å±•ç¤ºåŒº -->
    <div class="food-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
      <!-- èœå“ç”±JSåŠ¨æ€æ¸²æŸ“ -->
    </div>
  </main>

  <!-- åº•éƒ¨è´­ç‰©è½¦ï¼ˆå›ºå®šï¼‰æ ¸å¿ƒç»„ä»¶ -->
  <footer class="fixed bottom-0 left-0 right-0 bg-white shadow-lg border-t border-gray-200">
    <div class="cart-bar px-4 py-3 flex justify-between items-center">
      <div class="cart-icon relative" id="cartToggle">
        <i class="fa-solid fa-cart-shopping text-2xl text-orange-500"></i>
        <span class="cart-badge absolute -top-2 -right-2 w-5 h-5 rounded-full bg-red-500 text-white text-xs flex items-center justify-center">0</span>
        <span class="ml-2 font-medium">å®è´é¤ç›˜</span>
      </div>
      <div class="cart-price flex items-center gap-4">
        <span class="text-lg font-bold">åˆè®¡ï¼š<span class="total-price text-red-500">Â¥0.00</span></span>
        <button class="checkout-btn bg-orange-500 text-white px-6 py-2 rounded-full font-medium hover:bg-orange-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed">äº²äº²ä¸‹å•</button>
      </div>
    </div>
    <!-- å®å®çš„é¤ç›˜è¯¦æƒ…é¢æ¿ -->
    <div class="cart-detail hidden px-4 py-3 bg-gray-50 max-h-80 overflow-y-auto border-t border-gray-200">
      <div class="cart-empty text-center py-6 text-gray-500">
        <i class="fa-solid fa-empty-set text-3xl mb-2"></i>
        <p>é¤ç›˜è¿˜æ˜¯ç©ºçš„ï¼Œå®è´å¿«å»é€‰ç‚¹ç¾é£Ÿå§ï½</p>
      </div>
      <div class="cart-items hidden space-y-2"></div>
      <div class="cart-footer mt-3 flex justify-between items-center pt-2 border-t border-gray-200">
        <button class="clear-cart text-gray-500 hover:text-red-500 text-sm"><i class="fa-solid fa-trash"></i> æ¸…ç©ºé¤ç›˜</button>
        <span class="text-base font-bold">æ€»è®¡ï¼š<span class="total-price text-red-500">Â¥0.00</span></span>
      </div>
    </div>
  </footer>

  <script>
    // ========== 1. ç‚¹é¤ç³»ç»Ÿ èœå“æ•°æ®æºã€å¯ç›´æ¥ä¿®æ”¹/æ–°å¢/åˆ é™¤ï¼ŒæŒ‰éœ€æ”¹ã€‘ ==========
const foodData = [
      { id: 1, name: "çº¢çƒ§è‚‰", price: 520, desc: "æ¯›æ°çº¢çƒ§è‚‰ï¼Œå…¥å£å³åŒ–", type: "hot", img: "https://picsum.photos/id/287/300/200" },
      { id: 2, name: "å¹²ç…¸ç‚’é¢", price: 520, desc: "æ–°ç–†ç‰¹è‰²", type: "food", img: "https://picsum.photos/id/431/300/200" },
      { id: 3, name: "å°é…¥è‚‰", price: 520, desc: "å¤–é…¥é‡Œå«©ï¼Œé¦™çš„å¾ˆ", type: "snack", img: "https://picsum.photos/id/481/300/200" },
      { id: 4, name: "çç å¥¶èŒ¶", price: 520, desc: "å¤§é¢—é»‘ç³–çç +ä¸æ»‘å¥¶èŒ¶ï¼Œç”œåº¦å¯é€‰", type: "drink", img: "https://picsum.photos/id/429/300/200" },
      { id: 5, name: "è±Œè±†ç‚’è‚‰", price: 520, desc: "é…¸ç”œå¯å£ï¼Œæ±¤æ±æ‹Œé¥­è¶…é¦™", type: "hot", img: "https://picsum.photos/id/292/300/200" },
      { id: 6, name: "ç´«èœè›‹èŠ±æ±¤", price: 520, desc: "é²œé¦™æš–èƒƒï¼Œè§£è…»å¿…å¤‡", type: "soup", img: "https://picsum.photos/id/327/300/200" },
      { id: 7, name: "å››å­£è±†ç‚’è‚‰", price: 520, desc: "è¶…çº§ä¸‹é¥­", type: "hot", img: "https://picsum.photos/id/327/300/200" },
];
    // ========== 2. å…¨å±€å˜é‡ ==========
    const cartList = []; // è´­ç‰©è½¦æ•°ç»„ï¼Œå­˜å‚¨é€‰ä¸­çš„èœå“ {id,name,price,num}
    const foodListEl = document.querySelector('.food-list');
    const cartBadgeEl = document.querySelector('.cart-badge');
    const totalPriceEl = document.querySelectorAll('.total-price');
    const cartDetailEl = document.querySelector('.cart-detail');
    const cartItemsEl = document.querySelector('.cart-items');
    const cartEmptyEl = document.querySelector('.cart-empty');
    const checkoutBtn = document.querySelector('.checkout-btn');

    // ========== 3. åˆå§‹åŒ–é¡µé¢ï¼šæ¸²æŸ“æ‰€æœ‰èœå“ ==========
    renderFoodList(foodData);

    // ========== 4. äº‹ä»¶ç»‘å®š ==========
    // åˆ†ç±»åˆ‡æ¢äº‹ä»¶
    document.querySelectorAll('.category-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('category-active'));
        this.classList.add('category-active');
        const type = this.dataset.type;
        const filterFood = type === 'all' ? foodData : foodData.filter(item => item.type === type);
        renderFoodList(filterFood);
      });
    });

    // è´­ç‰©è½¦å±•å¼€/æ”¶èµ·äº‹ä»¶
    document.getElementById('cartToggle').addEventListener('click', () => {
      cartDetailEl.classList.toggle('hidden');
    });

    // æ¸…ç©ºè´­ç‰©è½¦äº‹ä»¶
    document.querySelector('.clear-cart').addEventListener('click', () => {
      if (cartList.length === 0) return;
      if (confirm('ç¡®å®šè¦æ¸…ç©ºç‚¹é¤ç›˜å—ï¼Ÿ')) {
        cartList.length = 0;
        updateCart();
      }
    });

    // ç»“ç®—æŒ‰é’®äº‹ä»¶
    checkoutBtn.addEventListener('click', () => {
      if (cartList.length === 0) {
        alert('ç‚¹é¤ç›˜ä¸ºç©ºï¼Œæ— æ³•ç»“ç®—å“¦ï½');
        return;
      }
      alert('âœ… ç‚¹é¤æˆåŠŸï¼è¯·äº²äº²ä½ çš„ç”·æœ‹å‹å®Œæˆæ”¯ä»˜ï¼Œç¥æ‚¨ç”¨é¤æ„‰å¿«ï½');
    });

    // ========== æ ¸å¿ƒæ–¹æ³•ï¼šæ¸²æŸ“èœå“åˆ—è¡¨ ==========
    function renderFoodList(list) {
      foodListEl.innerHTML = '';
      list.forEach(item => {
        const foodItem = document.createElement('div');
        foodItem.className = 'food-card';
        foodItem.innerHTML = `
          <img src="${item.img}" alt="${item.name}" class="w-full h-40 object-cover">
          <div class="p-3">
            <div class="flex justify-between items-start mb-2">
              <h3 class="font-bold text-gray-800">${item.name}</h3>
              <span class="text-red-500 font-bold">Â¥${item.price.toFixed(2)}</span>
            </div>
            <p class="text-sm text-gray-500 line-clamp-2 mb-3">${item.desc}</p>
            <div class="flex justify-between items-center">
              <div class="flex items-center gap-2" data-id="${item.id}">
                <span class="btn-num minus"><i class="fa-solid fa-minus"></i></span>
                <span class="num text-sm">0</span>
                <span class="btn-num plus"><i class="fa-solid fa-plus"></i></span>
              </div>
            </div>
          </div>
        `;
        foodListEl.appendChild(foodItem);
      });
      // ç»‘å®šèœå“çš„åŠ å‡æŒ‰é’®äº‹ä»¶
      bindFoodNumEvent();
    }

    // ========== æ ¸å¿ƒæ–¹æ³•ï¼šç»‘å®šèœå“æ•°é‡åŠ å‡äº‹ä»¶ ==========
    function bindFoodNumEvent() {
      // åŠ å·æŒ‰é’®ï¼šæ·»åŠ èœå“åˆ°è´­ç‰©è½¦
      document.querySelectorAll('.plus').forEach(btn => {
        btn.addEventListener('click', function() {
          const parent = this.parentElement;
          const id = Number(parent.dataset.id);
          const numEl = parent.querySelector('.num');
          let num = Number(numEl.innerText);
          num++;
          numEl.innerText = num;
          // æ›´æ–°è´­ç‰©è½¦
          addToCart(id, num);
        });
      });

      // å‡å·æŒ‰é’®ï¼šå‡å°‘èœå“æ•°é‡
      document.querySelectorAll('.minus').forEach(btn => {
        btn.addEventListener('click', function() {
          const parent = this.parentElement;
          const id = Number(parent.dataset.id);
          const numEl = parent.querySelector('.num');
          let num = Number(numEl.innerText);
          if (num <= 0) return; // æ•°é‡ä¸èƒ½å°äº0
          num--;
          numEl.innerText = num;
          // æ›´æ–°è´­ç‰©è½¦
          addToCart(id, num);
        });
      });
    }

    // ========== æ ¸å¿ƒæ–¹æ³•ï¼šæ·»åŠ /æ›´æ–°è´­ç‰©è½¦æ•°æ® ==========
    function addToCart(foodId, num) {
      const food = foodData.find(item => item.id === foodId);
      const cartItemIndex = cartList.findIndex(item => item.id === foodId);

      if (num === 0) {
        // æ•°é‡ä¸º0ï¼Œä»è´­ç‰©è½¦åˆ é™¤
        if (cartItemIndex > -1) cartList.splice(cartItemIndex, 1);
      } else {
        if (cartItemIndex > -1) {
          // èœå“å·²åœ¨è´­ç‰©è½¦ï¼Œæ›´æ–°æ•°é‡
          cartList[cartItemIndex].num = num;
        } else {
          // èœå“ä¸åœ¨è´­ç‰©è½¦ï¼Œæ–°å¢
          cartList.push({ id: food.id, name: food.name, price: food.price, num: num });
        }
      }
      // æ›´æ–°è´­ç‰©è½¦è§†å›¾å’Œæ•°æ®
      updateCart();
    }

    // ========== æ ¸å¿ƒæ–¹æ³•ï¼šæ›´æ–°è´­ç‰©è½¦æ‰€æœ‰è§†å›¾å’Œæ•°æ® ==========
    function updateCart() {
      // 1. è®¡ç®—è´­ç‰©è½¦æ€»æ•°é‡å’Œæ€»é‡‘é¢
      let totalNum = 0;
      let totalPrice = 0;
      cartList.forEach(item => {
        totalNum += item.num;
        totalPrice += item.price * item.num;
      });

      // 2. æ›´æ–°è´­ç‰©è½¦è§’æ ‡æ•°é‡
      cartBadgeEl.innerText = totalNum;

      // 3. æ›´æ–°åˆè®¡é‡‘é¢ï¼ˆå¤šå¤„åŒæ­¥æ›´æ–°ï¼‰
      totalPriceEl.forEach(el => el.innerText = `â¤â¤{totalPrice.toFixed(2)}`);

      // 4. æ›´æ–°è´­ç‰©è½¦è¯¦æƒ…é¢æ¿
      if (cartList.length === 0) {
        cartEmptyEl.classList.remove('hidden');
        cartItemsEl.classList.add('hidden');
        checkoutBtn.disabled = true; // è´­ç‰©è½¦ç©ºï¼Œç¦ç”¨ç»“ç®—
      } else {
        cartEmptyEl.classList.add('hidden');
        cartItemsEl.classList.remove('hidden');
        checkoutBtn.disabled = false; // æœ‰èœå“ï¼Œå¯ç”¨ç»“ç®—
        // æ¸²æŸ“è´­ç‰©è½¦èœå“åˆ—è¡¨
        cartItemsEl.innerHTML = '';
        cartList.forEach(item => {
          const cartItem = document.createElement('div');
          cartItem.className = 'flex justify-between items-center py-2 border-b border-gray-200';
          cartItem.innerHTML = `
            <div class="flex flex-col">
              <span class="font-medium">${item.name}</span>
              <span class="text-sm text-gray-500">â¤{item.price.toFixed(2)}/ä»½</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="cart-minus btn-num text-sm" data-id="â¤{item.id}">-</span>
              <span>${item.num}</span>
              <span class="cart-plus btn-num text-sm" data-id="â¤{item.id}">+</span>
              <span class="text-red-500 font-medium">â¤{(item.price * item.num).toFixed(2)}</span>
              <span class="cart-del text-gray-400 hover:text-red-500" data-id="â¤{item.id}"><i class="fa-solid fa-times"></i></span>
            </div>
          `;
          cartItemsEl.appendChild(cartItem);
        });
        // ç»‘å®šè´­ç‰©è½¦å†…çš„åŠ å‡/åˆ é™¤äº‹ä»¶
        bindCartItemEvent();
      }
    }

    // ========== æ ¸å¿ƒæ–¹æ³•ï¼šç»‘å®šè´­ç‰©è½¦å†…èœå“çš„æ“ä½œäº‹ä»¶ ==========
    function bindCartItemEvent() {
      // è´­ç‰©è½¦åŠ å·
      document.querySelectorAll('.cart-plus').forEach(btn => {
        btn.addEventListener('click', function() {
          const id = Number(this.dataset.id);
          const foodItem = cartList.find(item => item.id === id);
          foodItem.num++;
          syncFoodNum(id, foodItem.num);
          updateCart();
        });
      });
      // è´­ç‰©è½¦å‡å·
      document.querySelectorAll('.cart-minus').forEach(btn => {
        btn.addEventListener('click', function() {
          const id = Number(this.dataset.id);
          const foodItem = cartList.find(item => item.id === id);
          if (foodItem.num <= 1) {
            foodItem.num = 0;
            cartList.splice(cartList.findIndex(item => item.id === id), 1);
          } else {
            foodItem.num--;
          }
          syncFoodNum(id, foodItem.num);
          updateCart();
        });
      });
      // è´­ç‰©è½¦åˆ é™¤å•èœå“
      document.querySelectorAll('.cart-del').forEach(btn => {
        btn.addEventListener('click', function() {
          const id = Number(this.dataset.id);
          syncFoodNum(id, 0);
          cartList.splice(cartList.findIndex(item => item.id === id), 1);
          updateCart();
        });
      });
    }

    // ========== è¾…åŠ©æ–¹æ³•ï¼šåŒæ­¥èœå“å±•ç¤ºåŒºå’Œè´­ç‰©è½¦çš„æ•°é‡ ==========
    function syncFoodNum(foodId, num) {
      const numEl = document.querySelector(`[data-id="â¤{foodId}"] .num`);
      if (numEl) numEl.innerText = num;
    }
  </script>
</body>
</html>